<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
    <head lang="en">
        <title th:inline="text">mContent -  [[${content.title}]]</title>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" th:href="@{|/lib/jquery/jquery-ui.min.css|}"/>
        <link rel="stylesheet" th:href="@{|/lib/pure/pure-0.6.0.min.css|}"/>
        <link rel="stylesheet" th:href="@{|/css/show.css|}"/>
        <link rel="stylesheet" th:href="@{|/theme/css/fashion.css|}"/>
    </head>
    <body>
        <div class="themed-content">
            <div class="content">
                <div class="workarea">
                    <h1 th:inline="text">Latest SMS messages</h1>

                    <div class="sms-log" th:unless="${#lists.isEmpty(messages)}">
                        <!--    <div class="form-fields">
                                <label text="To">To</label>
                                <input id="nameFilter" name="nameFilter" type="text" th:value="${nameFilter}" required="false"/>
                                <a class="search-pipes pure-button" th:href="@{|${baseUrl}/1|}" th:text="#{general.search}">Search</a>
                            </div>
                            <div>
                                <ul class="pagination">
                                    <li th:class="${currentIndex == 1}? 'disabled' : '' ">
                                        <span th:if='${currentIndex == 1}'>First</span>
                                        <a class="linktopage" th:if='${currentIndex != 1}'
                                           th:href="@{|${baseUrl}/1|}"
                                           title='Go to first page'>First</a>
                                    </li>

                                    <li th:class="${currentIndex != 1}? '' : 'disabled' ">
                                        <span th:if='${currentIndex == 1}'>&lt;&lt;</span>
                                        <a class="linktopage" th:if='${currentIndex != 1}'
                                           th:href="@{|${baseUrl}/${currentIndex - 1}|}"
                                           title='Go to previous page'>&lt;&lt;</a>
                                    </li>

                                    <li th:each="item : ${#numbers.sequence(beginIndex, endIndex)}"
                                        th:class="${item == currentIndex ? 'active' : ''}">
                                        <span
                                            th:if='${item == currentIndex}' th:text='${item}'>1</span>
                                            <a class="linktopage" th:if='${item != currentIndex}'
                                              th:href="@{|${baseUrl}/${item}|}">
                                            <span th:text='${item}'>1</span>
                                            </a>
                                    </li>

                                    <li th:class="${currentIndex != totalPageCount}? '' : 'disabled' ">
                                        <span th:if='${currentIndex == totalPageCount}'>&gt;&gt;</span>
                                        <a class="linktopage" th:if='${currentIndex != totalPageCount}'
                                           th:href="@{|${baseUrl}/${currentIndex + 1}|}"
                                           title='Go to next page'>&gt;&gt;</a>
                                    </li>

                                    <li th:class="${currentIndex == totalPageCount}? 'disabled' : '' ">
                                        <span th:if='${currentIndex == totalPageCount}'>Last</span>
                                        <a class="linktopage" th:if='${currentIndex != totalPageCount}'
                                           th:href="@{|${baseUrl}/${totalPageCount}|}"
                                           title='Go to last page'>Last</a>
                                    </li>

                                </ul>
                            </div>
                        -->
                        <table class="pure-table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th th:text="#{smsmessage.sent}">Sent</th>
                                    <th th:text="#{smsmessage.message}">Message</th>
                                </tr>
                            </thead>
                            <tbody>

                                <tr th:each="message : ${messages}">
                                    <td th:text="${message.sent}?${#dates.format(message.sent, 'yyyy-MM-dd HH:mm:ss')}:''" >SENT</td>
                                    <td th:text="${message.message}">MESSAGE</td>
                                </tr>

                            </tbody>
                        </table>

                    </div>

                    <!--
                    <script sec:authorize="hasAnyRole('ADMIN')">

                        $(".linktopage").click(function (event) {
                            event.preventDefault();
                            mContent.loaders.workArea($(this).attr("href"));
                            return false;
                        });
                        $(".search-pipes").click(function () {
                            event.preventDefault();
                            $.ajax({
                                type: "GET",
                                data: {
                                    "nameFilter": document.getElementById("nameFilter").value
                                },
                                url: $(this).attr("href"),
                                success: function (data) {
                                    $("#workarea").html("").append(data);
                                }
                            });
                            return false;
                        });
                    </script>
                    -->
                </div>
            </div>
            <div class="user-menu">
                <div class="user-menu-content">
                    <form id="logout" th:action="@{/show/logout}" method="post">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    </form>
                    <div sec:authorize="hasRole('ADMIN')">
                        <span class="view-subscriber" title="Not available in preview mode">Subscription history</span> | <span class="view-subscriber" title="Not available in preview mode">Discover</span> | <span class="view-subscriber" title="Not available in preview mode">Latest messages</span> | <a onclick="$('#logout').submit();">Logout</a>
                    </div>
                    <div sec:authorize="!hasRole('ADMIN')">
                        <a class="view-subscriber" th:href="@{|/show/subscriber/history|(uuid=${short_uuid})}">Subscription history</a> | <a th:href="@{|/show/discover|(uuid=${short_uuid})}">Discover</a> | <a th:href="@{|/show/messages|(uuid=${short_uuid})}">Latest messages</a> | <a onclick="$('#logout').submit();">Logout</a>
                    </div>
                </div><br/>
                <div class="copy">mContent Platform. All rights Reserved</div>
            </div>
        </div>
        <script th:src="@{|/lib/jquery/jquery.min.js|}"></script>
        <script th:src="@{|/lib/jquery/jquery-ui.min.js|}"></script>
        <script th:src="@{|/js/config.js|}"></script>
        <script th:src="@{|/js/show/show.js|}"></script>


        <script th:src="@{|/lib/bootstrap/bootstrap.min.js|}"></script>
        <script th:src="@{|/lib/jquery/jquery.multi-select.js|}"></script>
        <script th:src="@{|/lib/jquery/jquery.dropdown.min.js|}"></script>
        <script th:src="@{|/lib/underscore/underscore.min.js|}"></script>
        <script th:src="@{|/lib/moment/moment.min.js|}"></script>
        <script th:src="@{|/lib/clndr/clndr.min.js|}"></script>
        <script th:src="@{|/lib/summernote/summernote.js|}"></script>

        <script th:src="@{|/js/alerts.js|}"></script>
        <script th:src="@{|/js/comm.js|}"></script>
        <script th:src="@{|/js/admin/config.js|}"></script>
        <script th:src="@{|/js/admin/popups.js|}"></script>
        <script th:src="@{|/js/admin/loaders.js|}"></script>

        <script th:inline="javascript">
            /*<![CDATA[*/
            $(".view-subinstructions").click(function () {
                event.preventDefault();
                mContent.popup.load(/*[[#{service.subscribeInstructions}]]*/ 'koe', $(this).attr("href"));

                return false;
            });
            /*]]>*/
        </script>
    </body>
</html>
