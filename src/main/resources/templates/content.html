<div class="content" th:unless="${#lists.isEmpty(deliverable)}">
    <formfield>
        <legend>Basic info</legend>
        <div th:if="${deliverable instanceof T(com.mnewservice.mcontent.domain.SeriesDeliverable)}" th:text="@{|Delivery position: ${deliverable.deliveryDaysAfterSubscription}|}"></div>
        <div th:if="${deliverable instanceof T(com.mnewservice.mcontent.domain.ScheduledDeliverable)}" th:text="@{|Delivery date: ${#calendars.format(deliverable.deliveryDate, 'yyyy-MM-dd')}|}"></div>
        <a th:href="@{|/show/a/${deliverable.content.uuid}|}" target='_blank'>Link</a>
    </formfield>
    <formfield>
        <legend>Content</legend>
        <form name="content-form" class="pure-form pure-form-stacked" action="#" th:action="@{|/deliverypipe/${deliveryPipeId}/${deliverable.type.name().toLowerCase()}/${deliverable.id}|}"
              method="post">
            <div class="form-fields">
                <div th:if="${error}" class="alert alert-error" th:text="#{deliverable.error}">
                    Error in content data.
                </div>
                <div th:if="${saved}" class="alert alert-success" th:text="#{deliverable.saved}">
                    Content saved.
                </div>
                <input type="hidden" name="id" th:value="${deliverable.id}"/>

                <input type="hidden" th:name="content.id" th:value="${deliverable.content.id}"/>

                <label for="content.title" th:text="#{content.title}">Title</label>
                <input type="text" required="true" name="content.title" th:value="${deliverable.content.title}"/>

                <label for="content.content" th:text="#{content.content}">Content</label>
                <textarea required="true" name="content.content" th:text="${deliverable.content.content}"/>

                <input type="hidden" th:name="save" />
                <input th:if="${deliverable instanceof T(com.mnewservice.mcontent.domain.SeriesDeliverable)}" type="hidden" th:name="deliveryDaysAfterSubscription" th:value="${deliverable.deliveryDaysAfterSubscription}"/>
                <input th:if="${deliverable instanceof T(com.mnewservice.mcontent.domain.ScheduledDeliverable)}" type="hidden" th:name="deliveryDate" th:value="${deliverable.deliveryDate}"/>
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            </div>
            <div class="form-actions">
                <a href="#" onclick="submitFormOnPopup(this, event);" th:text="#{general.save}">Save</a>
                <a href="#" onclick="closePopup(this, event);" th:text="#{general.cancel}">Cancel</a>
            </div>
        </form>
    </formfield>
    <div id="previewers">
        <div class="iphone-previewer">
            <div class="previewer-content"></div>
        </div>
        <div class="ipad-previewer">
            <div class="previewer-content"></div>
        </div>
    </div>
    <script>
        $("select[name='providers']").multiSelect();
        $("textarea[name='content.content']").summernote({
            onChange: function(e) {
                $(".previewer-content").html($("textarea[name='content.content']").code());
            }
        });
    </script>
</div>